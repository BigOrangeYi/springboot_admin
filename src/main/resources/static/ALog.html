<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="static/images/mr.jpg"/>
    <title>网上创作平台管理系统</title>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="css/mmss.css"/>
    <link rel="stylesheet" href="css/font-awesome.min.css"/>
    <link rel="stylesheet" href="css/jquery-uis.css"/>
    <link rel="stylesheet" href="css/jquery-uit.css"/>
    <script src="js/tx.js"></script>
    <script src="js/vue.js"></script>
    <script src="js/axios.js"></script>
    <script  src="js/jquery-3.4.1.min.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/jquery-ui.js"></script>

</head>
<body>
<header>
    <div class="container-fluid navbar-fixed-top bg-primary">
        <ul class="nav navbar-nav  left">
            <li class="text-white h4">
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="glyphicon glyphicon-leaf"></span>&nbsp;&nbsp;<b>网上创作平台管理系统</b>
            </li>
        </ul>
        <ul class="nav navbar-nav nav-pills right ">
            <!-- <li class="bg-warning ">
                 <a href="#"><span class="glyphicon glyphicon-tasks"></span><span class="badge">1</span></a>
             </li>
             <li class="bg-success">
                 <a href="#"><span class="glyphicon glyphicon-envelope"></span><span class="badge">2</span></a>
             </li>
             <li class="bg-danger">
                 <a href="#"><span class="glyphicon glyphicon-bell"></span></a>
             </li>-->
            <li class="bg-info dropdown">
                <a class="dropdown-toggle" href="#" data-toggle="dropdown">
                    <span class="glyphicon glyphicon-user"></span>&nbsp;<span>系统管理员</span><span class="caret"></span>
                </a>
                <ul class="dropdown-menu dropdown-menu-right">
                    <li class="text-center"><a href="login"><span class="text-primary">退出</span></a></li>
                </ul>
            </li>
        </ul>
    </div>
</header>
<div id="Index">
    <br><br><br>
    <div class="container-fluid" >
        <div class="row ">
            <!--左侧导航开始-->
            <div class="col-xs-2 ">
                <br/>
                <div class="panel-group sidebar-menu" id="accordion" aria-multiselectable="true">
                    <div class="panel panel-default menu-first menu-first-active">
                        <a data-toggle="collapse" data-parent="#accordion" href="/adminIndex" aria-expanded="true"
                           aria-controls="collapseOne">
                            <i class="icon-home icon-large"></i> 主页
                        </a>
                    </div>
                    <div class="panel panel-default menu-first">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true"
                           aria-controls="collapseOne">
                            <i class="icon-user-md icon-large"></i> 网站角色管理</a>
                        </a>

                        <div >
                            <ul class="nav nav-list menu-second">
                                <li><a  href="AUser.html" style="height: 50px;line-height: 50px;"><i class="icon-user"></i> 用户管理</a></li>
                                <li><a  href="AAuthor.html"style="height: 50px;line-height: 50px;"><i class="icon-user"></i> 作者管理</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="panel panel-default menu-first">
                        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo"
                           aria-expanded="false" aria-controls="collapseTwo">
                            <i class="icon-book icon-large"></i> 网站作品管理</a>
                        </a>
                        <div >
                            <ul class="nav nav-list menu-second">
                                <li><a href="AWork.html"style="height: 50px;line-height: 50px;"><i class="icon-book"></i> 作品信息管理</a></li>
                                <li><a href="AComment.html"style="height: 50px;line-height: 50px;"><i class="icon-book"></i>作品评论管理</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="panel panel-default menu-first">
                        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree"
                           aria-expanded="false" aria-controls="collapseThree">
                            <i class="icon-book icon-large"></i> 网站日志管理</a>
                        </a>

                        <div >
                            <ul class="nav nav-list menu-second">
                                <li><a href="ALog.html"style="height: 50px;line-height: 50px;"><i class="icon-user"></i>用户日志管理</a></li>
                                <li><a href="ALog.html"style="height: 50px;line-height: 50px;"><i class="icon-user"></i>作者日志管理</a></li>
                                <li><a href="ALog.html"style="height: 50px;line-height: 50px;"><i class="icon-book"></i>作品日志管理</a></li>
                                <li><a href="ALog.html"style="height: 50px;line-height: 50px;"><i class="icon-book"></i>章节日志管理</a></li>
                                <li><a href="ALog.html"style="height: 50px;line-height: 50px;"><i class="icon-list"></i>评论日志管理</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!--左侧导航结束-->
            <!--右侧内容开始-->
            <div class="col-xs-10" id="app">
                <br/>
                <ol class="breadcrumb">
                    <li><a href="adminIndex"><span class="glyphicon glyphicon-home"></span>&nbsp;后台首页</a></li>
                    <li class="active">网站日志管理</li>
                </ol>
                <table class="table table-bordered table-striped text-center bg-info">
                    <tr class="info">
                        <td @click="altertable('users_log')">
                            用户日志
                        </td>
                        <td @click="altertable('authors_log')">
                            作者日志
                        </td>
                        <td @click="altertable('chapters_log')">
                            章节日志
                        </td>
                        <td @click="altertable('bookshelfs_log')">
                            书架日志
                        </td>
                        <td @click="altertable('books_log')">
                            书籍日志
                        </td>
                        <td @click="altertable('comments_log')">
                            评论日志
                        </td>
                    </tr>
                </table>
    <div align="center">
    <br> <br> <br>
    <table class="table table-bordered table-striped text-center bg-info">
        <tr class="info"><td>logid</td>
            <td colspan="2" class="text-center">aactions</td>
            <td class="text-center">logdate</td>
            <td class="text-center">操作</td></tr>
        <tr v-for="(Log,LogNum) in Logs" class="info">
            <td class="text-center">{{Log.logid}}</td>
            <td class="text-center" colspan="2" v-if="tablename=='chapters_log'"><textarea style="height: 150px;weight:150px;">{{Log.aactions}}</textarea></td>
            <td class="text-center" colspan="2" v-if="tablename!='chapters_log'">{{Log.aactions}}</td>
            <td class="text-center">{{Log.logdate}}</td>
            <td class="text-center" @click="ADeleteLogs(Log.logid)">确定删除</td>
        </tr>
    </table>
    <br>
    <div align="center">
        <a @click="Pre">上一页</a>
        第<input v-model="VPageNum" type="number" size="3">页<input type="button" value="跳转" @click="todo(VPageNum)" >
        <a @click="Next">下一页</a>
    </div>
        </div>
        </div>
    </div>
</div>
</div>
<script>
    var PageNum=1;
    var PageSize=6;
    $(function () {
        vindex.ASelectLogs(PageNum,PageSize);
    });
    var vindex = new Vue({
        el: '#Index',
        data: {

            VPageNum:'',
            Logs:[],
            tablename:"users_log"
        },
        mounted: function (){},
        methods:{
altertable:function(tablename){
vindex.tablename=tablename;
vindex.ASelectLogs(PageNum,PageSize);
},
            Pre:function(){
                if (PageNum > 1)
                {
                    vindex.VPageNum=--PageNum;
                    vindex.ASelectLogs(PageNum,PageSize);
                }
            },
            Next:function(){
                if (vindex.Logs.length == 6)
                {
                    vindex.VPageNum=++PageNum;
                    vindex.ASelectLogs(PageNum,PageSize);
                }
            },
            todo:function(Num){
                if (Num > 0)
                {
                    PageNum=Num;
                    vindex.ASelectLogs(PageNum,PageSize);
                }
            },

            ADeleteLogs:function(logid){
                axios.post('ADeleteLogs.do', {
                    logid:logid,
                    tablename:vindex.tablename
                }).then(function (response) {
                    var temp = response.data;console.log(temp);
                    if (temp==1){
                        alert("删除成功");
                        vindex.ASelectLogs(PageNum,PageSize);
                    }
                    else alert("删除失败")
                });
            },
            ASelectLogs:function (PageNum,PageSize) {
                vindex.Logs=[];
                axios.post('ASelectLogs.do', {
                    PageNum:PageNum,
                    PageSize:PageSize,
                    tablename:vindex.tablename
                }).then(function (response) {
                    var temp = response.data;console.log(temp);
                    for (var i = 0; i < temp.length; i++)
                        vindex.Logs.push({
                            logid:temp[i].logid,
                            aactions:temp[i].aactions,
                            logdate:temp[i].logdate
                        });
                })
            }
        }
    });
</script>
</body>
</html>